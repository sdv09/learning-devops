### 4.5. NAT [Степанников Денис]
## Задание 1
Вы подняли на своём домашнем компьютере с IP-адресом `192.168.0.2` web-сервер.

* Получится ли у пользователей интернета открыть этот сайт?
* Нужно ли будет вам для этого что-то сделать дополнительно?
* Существует ли такой набор настроек провайдера, который не позволит подключение?
 
## Решение:
* Без трансляции нет, т.к. это частная сеть и не доступна из интернет.
* Да, настроить публикацию (DNAT) с внешнего адреса (через который web сервер выходит в интернет) на 192.168.0.2.


## Задание 2
- Узел `src` инициировал соединение с узлом `dst`.
- На маршрутизаторе узла `src` была создана трансляция:


| src local IP:port | src global IP:port | dst IP | protocol
| -------- | -------- | -------- | -------- |
| 10.0.0.2:1111     | 93.15.10.2:2222     | 1.1.1.1:80     |tcp|

Применив знания по установке TCP сессий, ответьте на вопросы:
* Сможет ли злоумышленник доставить пакет до `10.0.0.2`, отправив пакет на адрес/порт `93.15.10.2:2222` с адреса `74.5.12.4`?
* А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - `1.1.1.1:80`

## Решение:
* Нет
* Да, но только случае, если в таблице NAT уже существует запись об указанной трансляции, т.е пакет от злоумышленника будет воспринят как ответ на ранее отправленный пакет.


## Задание 3
- Узел `src` инициировал соединение с узлом `dst`.
- На маршрутизаторе узла `src` была создана трансляция:


| src local IP:port | src global IP:port | dst IP | protocol
| -------- | -------- | -------- | -------- |
| 10.0.0.2:1111     | 93.15.10.2:2222     | 8.8.8.8:53     |udp|

Применив знания по работе UDP, ответьте на вопросы:
* Сможет ли злоумышленник доставить пакет до `10.0.0.2`, отправив пакет на адрес/порт `93.15.10.2:2222` с адреса `74.5.12.4`?
* А если злоумышленник подменит source IP-адрес и сгенерирует пакет с source IP:port - `8.8.8.8:53`

## Решение:
* Нет
* Аналогично предыдущему заданию - Да, но только случае, если в таблице NAT уже существует запись об указанной трансляции, т.е пакет от злоумышленника будет воспринят как ответ на ранее отправленный пакет.


## Задание 4
Найдите самую часто встречающуюся проблему при работе клиентов за NAT с протоколом FTP, связанную с особенностью работы FTP (на лекции по портам эта особенность упоминалась).

1. В чём выражается проблема?
2. Почему она возникает?
3. Что можно сделать, чтобы избежать этой проблемы?


## Решение:
1. В активном режиме работы FTP клиент передает серверу управляющую команду PORT, которой указывает на какой порт тот должен установить канал передачи данных. 
Если клиент находится за NAT в приватной сети, то для корректной работы такого механизма должна существовать соответствующая DNAT-трансляция на пограничном маршрутизаторе, 
что обычно невозможно, например, в сценарии когда клиент один из сотни хостов в офисной сети за Overload NAT.

2. Если клиент находится за NAT в приватной сети, то для корректной работы такого механизма должна существовать соответствующая DNAT-трансляция на пограничном маршрутизаторе, 
что обычно невозможно, например, когда клиент один из сотни хостов в офисной сети за Overload NAT.

3. Переключение протокола FTP на работу в пассивном режиме, когда сервер указывает клиенту на какой порт устанавливать соединение. В таком случае не требуется заранее создавать DNAT-трансляцию.
