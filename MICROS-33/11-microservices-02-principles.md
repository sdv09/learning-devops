### Домашнее задание к занятию "Микросервисы: принципы" [Степанников Денис]

---
## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.


### Решение:

## Задача 1: API Gateway 
Для обеспечения реализации API Gateway и удовлетворения перечисленных требований (маршрутизация запросов, проверка аутентификационной информации, терминация HTTPS), можно рассмотреть несколько популярных решений. Основные кандидаты для сравнения:

1. Amazon API Gateway
2. Kong
3. NGINX
4. Apigee
5. Traefik

Составим сравнительную таблицу возможностей этих решений:

| Возможности / Решение   | Amazon API Gateway        | Kong                                       | NGINX                                      | Apigee                               | Traefik                          |
|-------------------------|---------------------------|--------------------------------------------|--------------------------------------------|--------------------------------------|----------------------------------|
| Маршрутизация запросов  | Да                        | Да                                         | Да                                         | Да                                   | Да                               |
| Проверка аутентификации | Да (IAM, Cognito, Lambda) | Да (плагины, OAuth2)                       | Да (через модули, внешние скрипты)         | Да (OAuth2, OpenID Connect)          | Да (через middleware)            |
| Терминация HTTPS        | Да                        | Да                                         | Да                                         | Да                                   | Да                               |
| Управление API          | Да (консоль, CLI, SDK)    | Да (Kong Manager, REST API)                | Нет (требуются дополнительные инструменты) | Да (консоль, REST API)               | Нет (упрощенное управление)      |
| Масштабируемость        | Высокая (серверлесс)      | Высокая (кластеризация)                    | Средняя (настройка вручную)                | Высокая                              | Средняя (настройка вручную)      |
| Расширяемость           | Средняя (через Lambda)    | Высокая (плагины)                          | Высокая (модули, Lua скрипты)              | Высокая (плагины, прокси)            | Средняя (middleware)             |
| Стоимость               | Зависит от использования  | Open Source + Платные версии               | Open Source + Платные модули               | Платформа с оплатой за использование | Open Source + Платные версии     |
| Поддержка               | Да (AWS Support)          | Да (Kong Inc., сообщество)                 | Да (NGINX Inc., сообщество)                | Да (Google Cloud Support)            | Да (Traefik Labs, сообщество)    |
| Документация и обучение | Отличная (много ресурсов) | Отличная (подробная документация, примеры) | Хорошая (подробная документация)           | Отличная (много ресурсов)            | Хорошая (подробная документация) |


Исходя таблицы выше, для выбора API Gateway стоит учесть несколько факторов:

1. **Маршрутизация запросов и проверка аутентификации** поддерживаются всеми решениями.
2. **Терминация HTTPS** также доступна во всех решениях.
3. **Управление API и Масштабируемость** могут быть критичны в зависимости от объема и роста нагрузки. Amazon API Gateway и Apigee предлагают наиболее удобные и масштабируемые решения из коробки.
4. **Расширяемость** важна, если требуется интеграция с нестандартными сервисами или бизнес-логикой. Kong и Apigee обеспечивают высокую степень расширяемости.
5. **Стоимость и поддержка** зависят от бюджета и требований к поддержке. Open Source решения (Kong, NGINX, Traefik) бесплатны, но потребуют затрат на настройку и поддержку.
---

## Задача 2: Брокер сообщений

Для обеспечения реализации брокера сообщений, удовлетворяющего перечисленным требованиям (кластеризация, хранение сообщений, высокая скорость, поддержка различных форматов, разделение прав доступа, простота эксплуатации), можно рассмотреть несколько популярных решений:

1. Apache Kafka
2. RabbitMQ
3. Apache ActiveMQ
4. NATS
5. Amazon SQS

Составим сравнительную таблицу возможностей этих решений:
| Возможности / Решение         | Apache Kafka                    | RabbitMQ                        | Apache ActiveMQ                | NATS                        | Amazon SQS                 |
|-------------------------------|---------------------------------|---------------------------------|--------------------------------|-----------------------------|----------------------------|
| Кластеризация                 | Да (Kafka Cluster)              | Да (кластеризация и HA)         | Да (брокеры и мастер-слейв)    | Да (NATS Streaming)         | Да (встроенная)            |
| Хранение сообщений на диске   | Да                              | Да                              | Да                             | Ограничено (NATS Streaming) | Да                         |
| Высокая скорость работы       | Очень высокая                   | Высокая                         | Средняя                        | Очень высокая               | Высокая                    |
| Поддержка различных форматов  | Да (JSON, Avro, Protobuf и др.) | Да (JSON, XML, AMQP и др.)      | Да (JMS, JSON, XML и др.)      | Ограничено (JSON, Protobuf) | Да (S3, SNS, Lambda и др.) |
| Разделение прав доступа       | Да (ACLs, SASL)                 | Да (гранулированное управление) | Да (JMS Security, ACLs)        | Ограничено (NATS Streaming) | Да (IAM policies)          |
| Простота эксплуатации         | Средняя                         | Высокая                         | Средняя                        | Высокая                     | Очень высокая              |
| Поддержка транзакций          | Да                              | Да                              | Да                             | Ограничено                  | Да                         |
| Поддержка многопротокольности | Нет                             | Да (AMQP, MQTT, STOMP и др.)    | Да (JMS, AMQP, OpenWire и др.) | Нет                         | Нет                        |
| Сообщество и поддержка        | Очень большое                   | Большое                         | Среднее                        | Растущее                    | Большое (AWS)              |


Обоснование выбора
Исходя из таблицы выше, для выбора брокера сообщений стоит учесть несколько факторов:

1. **Кластеризация и надежность**: Apache Kafka и RabbitMQ предлагают надежную кластеризацию и высокую доступность. Kafka также известна своей способностью обрабатывать большие объемы данных в режиме реального времени.
2. **Хранение сообщений на диске**: Все решения, кроме NATS, обеспечивают надежное хранение сообщений на диске.
3. **Высокая скорость работы**: Apache Kafka и NATS лидируют по скорости работы, что критично для высоконагруженных систем.
4. **Поддержка различных форматов сообщений**: RabbitMQ и Apache ActiveMQ поддерживают множество форматов и протоколов, что обеспечивает гибкость интеграций.
5. **Разделение прав доступа**: Apache Kafka и RabbitMQ предлагают гибкие механизмы управления доступом.
6. **Простота эксплуатации**: RabbitMQ и Amazon SQS выделяются простотой настройки и эксплуатации, что может быть важным для быстрого развертывания и минимизации операционных затрат.