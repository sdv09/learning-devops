### Домашнее задание к занятию "Микросервисы: подходы" [Степанников Денис]

---
## Задача 1: Обеспечить разработку

Предложите решение для обеспечения процесса разработки: хранение исходного кода, непрерывная интеграция и непрерывная поставка. 
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- облачная система;
- система контроля версий Git;
- репозиторий на каждый сервис;
- запуск сборки по событию из системы контроля версий;
- запуск сборки по кнопке с указанием параметров;
- возможность привязать настройки к каждой сборке;
- возможность создания шаблонов для различных конфигураций сборок;
- возможность безопасного хранения секретных данных (пароли, ключи доступа);
- несколько конфигураций для сборки из одного репозитория;
- кастомные шаги при сборке;
- собственные докер-образы для сборки проектов;
- возможность развернуть агентов сборки на собственных серверах;
- возможность параллельного запуска нескольких сборок;
- возможность параллельного запуска тестов.

Обоснуйте свой выбор.

## Задача 2: Логи

Предложите решение для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- сбор логов в центральное хранилище со всех хостов, обслуживающих систему;
- минимальные требования к приложениям, сбор логов из stdout;
- гарантированная доставка логов до центрального хранилища;
- обеспечение поиска и фильтрации по записям логов;
- обеспечение пользовательского интерфейса с возможностью предоставления доступа разработчикам для поиска по записям логов;
- возможность дать ссылку на сохранённый поиск по записям логов.

Обоснуйте свой выбор.

## Задача 3: Мониторинг

Предложите решение для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- сбор метрик со всех хостов, обслуживающих систему;
- сбор метрик состояния ресурсов хостов: CPU, RAM, HDD, Network;
- сбор метрик потребляемых ресурсов для каждого сервиса: CPU, RAM, HDD, Network;
- сбор метрик, специфичных для каждого сервиса;
- пользовательский интерфейс с возможностью делать запросы и агрегировать информацию;
- пользовательский интерфейс с возможностью настраивать различные панели для отслеживания состояния системы.

Обоснуйте свой выбор.


### Решение:

#### Задача 1: Обеспечить разработку

Для обеспечения процесса разработки с учетом всех указанных требований, можно рассмотреть использование следующих облачных сервисов:

- **GitHub** или **GitLab** для хранения исходного кода и системы контроля версий.
- **GitHub Actions** или **GitLab CI/CD** для непрерывной интеграции и непрерывной поставки (CI/CD).

#### Решение на базе GitHub и GitHub Actions

#### 1. Хранение исходного кода

- **GitHub**: предоставляет облачное хранилище исходного кода с поддержкой Git и возможностью создания репозиториев для каждого сервиса.

#### 2. Непрерывная интеграция и поставка

- **GitHub Actions**: позволяет настроить CI/CD процессы с запуском сборки по событиям из системы контроля версий или по кнопке с указанием параметров.

#### Принципы взаимодействия

#### Хранение исходного кода

- **Репозитории**: Каждый сервис хранится в отдельном репозитории на GitHub.

#### Непрерывная интеграция и поставка

- **Запуск сборки по событию**: Использование триггеров на события, такие как push, pull request и т.д., для автоматического запуска сборок.
- **Запуск сборки по кнопке**: Использование ручных триггеров (workflow_dispatch) в GitHub Actions для запуска сборки с указанием параметров.

#### Настройки и шаблоны сборок

- **Файлы конфигурации**: Workflow файлы (YAML) в репозитории, которые можно настраивать для различных типов сборок.
- **Шаблоны**: Возможность создания шаблонных workflow для повторного использования в различных проектах.

#### Безопасное хранение секретных данных

- **GitHub Secrets**: Секреты (пароли, ключи) хранятся в зашифрованном виде и используются в workflow.

#### Конфигурации сборок

- **Множество конфигураций**: Возможность создания различных workflow для разных конфигураций сборок из одного репозитория.

#### Кастомные шаги и докер-образы

- **Кастомные шаги**: В GitHub Actions можно добавлять кастомные шаги на любом этапе сборки.
- **Docker**: Возможность использования собственных докер-образов для выполнения задач сборки.

#### Агенты сборки и параллельные сборки

- **Собственные агенты**: Возможность развернуть самоуправляемые runners на собственных серверах.
- **Параллельные сборки и тесты**: Поддержка параллельного выполнения задач для ускорения процессов CI/CD.

### Обоснование выбора

##### GitHub и GitHub Actions

- **Облачная система**: GitHub предоставляет облачное хранилище для исходного кода и интегрированную систему CI/CD.
- **Система контроля версий Git**: Полная поддержка Git с возможностью создания репозиториев для каждого сервиса.
- **CI/CD**: GitHub Actions обеспечивает гибкость в настройке и запуске сборок по событиям и вручную.
- **Шаблоны и конфигурации**: Возможность создавать и использовать шаблоны workflow для различных типов сборок.
- **Секреты**: Безопасное хранение и использование секретных данных.
- **Кастомизация**: Поддержка кастомных шагов и использование докер-образов.
- **Агенты и параллелизм**: Возможность развертывания собственных агентов сборки и выполнения параллельных задач.

---

## Задача 2: Логи

#### Решение для сбора и анализа логов в микросервисной архитектуре

Для обеспечения сбора и анализа логов сервисов в микросервисной архитектуре, можно использовать следующие программные продукты:

- **Fluentd** или **Logstash** для сбора и агрегации логов.
- **Elasticsearch** для хранения и поиска логов.
- **Kibana** для визуализации и анализа логов.

#### Принципы взаимодействия

#### Сбор логов в центральное хранилище

- **Fluentd** или **Logstash**: Эти инструменты будут установлены на каждом хосте и настроены на сбор логов из stdout. Они агрегируют логи и отправляют их в центральное хранилище, обеспечивая минимальные требования к приложениям.

#### Гарантированная доставка логов

- **Fluentd** и **Logstash**: Обеспечивают гарантированную доставку логов с помощью механизмов подтверждения (acknowledgment) и повторных попыток в случае неудачи доставки.

#### Хранение и поиск логов

- **Elasticsearch**: Централизованное хранилище логов, поддерживающее мощный механизм поиска и фильтрации по записям логов.

#### Пользовательский интерфейс

- **Kibana**: Предоставляет удобный пользовательский интерфейс для поиска, фильтрации и визуализации логов. Также позволяет предоставлять доступ разработчикам для работы с логами.

#### Сохранённые поиски и ссылки

- **Kibana**: Позволяет сохранять поисковые запросы и создавать ссылки на сохранённые поиски, что упрощает доступ и анализ логов.

#### Обоснование выбора

#### Fluentd или Logstash

- **Сбор логов в центральное хранилище**: Обеспечивают сбор логов со всех хостов и их отправку в центральное хранилище.
- **Минимальные требования к приложениям**: Собирают логи из stdout, что минимизирует изменения в приложениях.
- **Гарантированная доставка**: Используют механизмы подтверждения и повторных попыток для надежной доставки логов.

#### Elasticsearch

- **Хранение логов**: Обеспечивает надежное хранение и быстрый доступ к логам.
- **Поиск и фильтрация**: Поддерживает мощные возможности поиска и фильтрации логов.

#### Kibana

- **Пользовательский интерфейс**: Предоставляет удобный интерфейс для работы с логами.
- **Доступ для разработчиков**: Обеспечивает разработчикам доступ к логам для анализа.
- **Сохранённые поиски**: Позволяет сохранять поисковые запросы и создавать ссылки на них для быстрого доступа.

## Задача 3: Мониторинг

#### Решение для сбора и анализа состояния хостов и сервисов в микросервисной архитектуре

Для обеспечения сбора и анализа состояния хостов и сервисов в микросервисной архитектуре, можно использовать следующие программные продукты:

- **Prometheus** для сбора и хранения метрик.
- **Node Exporter** для сбора метрик состояния ресурсов хостов.
- **cAdvisor** для сбора метрик потребляемых ресурсов для каждого сервиса.
- **Grafana** для визуализации и анализа метрик.

#### Принципы взаимодействия

#### Сбор метрик со всех хостов

- **Prometheus**: Центральный компонент системы мониторинга, который периодически опрашивает экспортеры метрик и сохраняет их в своей базе данных.

#### Сбор метрик состояния ресурсов хостов

- **Node Exporter**: Экспортер метрик, который собирает информацию о состоянии ресурсов хостов (CPU, RAM, HDD, Network) и предоставляет их Prometheus.

#### Сбор метрик потребляемых ресурсов для каждого сервиса

- **cAdvisor**: Экспортер метрик, который собирает информацию о потребляемых ресурсах для каждого контейнера (CPU, RAM, HDD, Network) и предоставляет их Prometheus.

#### Сбор метрик, специфичных для каждого сервиса

- **Prometheus**: Поддерживает сбор метрик, специфичных для каждого сервиса, с помощью настройки соответствующих endpoints в приложениях.

#### Пользовательский интерфейс для запросов и агрегации информации

- **Grafana**: Предоставляет мощный пользовательский интерфейс для создания запросов к метрикам, их агрегации и визуализации.

#### Пользовательский интерфейс для настройки панелей

- **Grafana**: Позволяет настраивать различные панели для отслеживания состояния системы, создавать дашборды и настраивать уведомления.

#### Обоснование выбора

#### Prometheus

- **Сбор метрик**: Мощная система для сбора и хранения метрик со всех хостов.
- **Гибкость**: Поддерживает сбор как стандартных, так и кастомных метрик.
- **Сообщество и поддержка**: Широко используется в индустрии, имеет активное сообщество и множество интеграций.

#### Node Exporter

- **Сбор метрик ресурсов хостов**: Специализированный инструмент для сбора информации о состоянии хостов.
- **Легкость развертывания**: Прост в установке и использовании.

#### cAdvisor

- **Сбор метрик контейнеров**: Специализированный инструмент для сбора метрик ресурсов контейнеров.
- **Интеграция с Prometheus**: Легко интегрируется с Prometheus для централизованного сбора метрик.

#### Grafana

- **Пользовательский интерфейс**: Обеспечивает мощные возможности визуализации, позволяет создавать запросы и агрегировать данные.
- **Настраиваемые панели**: Предоставляет гибкие возможности для создания дашбордов и панелей мониторинга.
